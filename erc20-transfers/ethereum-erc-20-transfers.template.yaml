name: ethereum-erc-20-transfers
apiVersion: 3
sources:
  ethereum.erc20_transfers:
    dataset_name: ethereum.erc20_transfers
    type: dataset
    version: 1.2.0

# note: filter in source was not working, so we're using a transform to filter the data
transforms:
  valid_transfers:
    sql: |
      SELECT * FROM ethereum.erc20_transfers
      WHERE address IN ({{addresses}})
    primary_key: id
sinks:
  postgres_ethereum_erc20_transfers:
    type: postgres
    table: ethereum_erc20_transfers
    schema: public
    secret_name: NEON_ROYCO
    description: 'Postgres sink for: ethereum.erc20_transfers'
    from: valid_transfers
